<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de R√≥tulos V8 (Eco & Color)</title>
    <!-- Fontes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@700&family=Dancing+Script:wght@700&family=Lato:wght@300;400;700;900&family=Oswald:wght@500&family=Playfair+Display:wght@600&family=Roboto+Mono:wght@400&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background-color: #e3e8ec;
            margin: 0;
            padding: 20px;
            text-align: center;
            color: #444;
        }

        /* --- PAINEL DE CONTROLE --- */
        .controls {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            max-width: 1000px;
            margin: 0 auto 40px auto;
            text-align: left;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .section-header {
            grid-column: span 4;
            font-size: 13px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #5D4037;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 8px;
            margin-bottom: 10px;
            margin-top: 15px;
        }
        .section-header:first-child { margin-top: 0; }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 700;
            margin-bottom: 4px;
            font-size: 10px;
            color: #888;
            text-transform: uppercase;
        }

        .control-group input[type="text"], 
        .control-group input[type="number"],
        .control-group select, 
        .control-group textarea {
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-family: inherit;
            font-size: 13px;
            background: #f9f9f9;
            transition: border 0.2s;
        }
        .control-group input:focus, .control-group select:focus {
            border-color: #5D4037;
            outline: none;
            background: white;
        }

        /* Inputs de Cor Compactos */
        .color-row {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        input[type="color"] {
            border: none;
            width: 30px;
            height: 38px;
            cursor: pointer;
            background: none;
            padding: 0;
            border-radius: 4px;
        }

        input[type=range] {
            width: 100%;
            accent-color: #5D4037;
        }

        /* Checkbox customizado */
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
            cursor: pointer;
        }
        .checkbox-wrapper input {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #5D4037;
        }
        .checkbox-wrapper span {
            font-size: 12px;
            font-weight: bold;
            color: #333;
        }

        /* Bot√µes */
        .full-width { grid-column: span 4; }
        .half-width { grid-column: span 2; }
        
        .btn-action {
            background-color: #5D4037;
            color: white;
            padding: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            width: 100%;
            transition: transform 0.1s, background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-action:hover { background-color: #3e2b24; transform: translateY(-2px); }

        .btn-upload {
            background-color: #546E7A;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            font-weight: 600;
            font-size: 13px;
        }

        /* --- VISUALIZA√á√ÉO --- */
        .preview-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 60px;
        }

        .sheet-wrapper { position: relative; }
        
        .sheet-label {
            position: absolute;
            top: -30px;
            left: 0;
            font-weight: 900;
            font-size: 14px;
            color: #5D4037;
            background: #e3e8ec;
            padding: 5px 15px 5px 0;
        }

        .sheet {
            background-color: white; /* Folha sempre branca */
            width: 210mm;
            height: 297mm;
            padding: 10mm; 
            box-sizing: border-box;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            justify-content: center;
            gap: 4mm;
            overflow: hidden;
        }

        /* --- LABEL SIDE --- */
        .label-side {
            background-color: var(--label-bg, transparent);
            display: flex;
            box-sizing: border-box;
            color: #2c1810; 
            position: relative;
        }
        
        /* Guia de corte (Vis√≠vel se fundo for transparente) */
        .cut-guide {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border: 1px dashed rgba(0,0,0,0.1); /* Bem sutil */
            pointer-events: none;
        }

        .label-side .content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            padding: 0 4%;
            /* Borda din√¢mica baseada na cor de detalhes */
            border: 2px solid var(--details-color, #3e2723);
            box-sizing: border-box;
            overflow: hidden;
        }

        .text-area-left {
            text-align: left;
            flex: 1;
            padding-right: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }

        .dynamic-title {
            margin: 0;
            line-height: 0.85;
            white-space: nowrap;
        }

        .dynamic-subtitle {
            margin: 4px 0 0 0;
            font-weight: normal;
            line-height: 1;
        }

        .dynamic-ingredients {
            margin-top: 6px;
            line-height: 1.1;
        }

        .info-box {
            text-align: center;
            /* Borda lateral din√¢mica */
            border-left: 2px solid var(--details-color, #3e2723);
            color: var(--details-color, #3e2723);
            padding-left: 10px;
            margin-left: 5px;
            min-width: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* --- LABEL LID --- */
        .label-lid {
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            box-sizing: border-box;
            /* Fundo da tampa segue a regra global */
        }
        
        .lid-cut-guide {
            position: absolute;
            width: 100%; height: 100%;
            border: 1px dashed #ddd;
            border-radius: 50%;
            top: 0; left: 0;
        }

        .label-lid .inner-circle {
            width: 94%;
            height: 94%;
            border: 2px solid var(--details-color, #000); /* Borda segue detalhes */
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: var(--label-bg, transparent); /* Fundo din√¢mico */
            z-index: 1;
        }

        .qr-placeholder {
            width: 55%;
            height: 55%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 2px 0;
        }
        .qr-placeholder img { width: 100%; height: 100%; object-fit: contain; }

        @media print {
            body { background: none; margin: 0; padding: 0; }
            .controls, h1, .subtitle, .sheet-label { display: none; }
            .preview-container { gap: 0; display: block; }
            .sheet-wrapper { margin: 0; page-break-after: always; }
            .sheet { box-shadow: none; margin: 0 auto; border: none; page-break-after: always; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>

    <!-- PAINEL -->
    <div class="controls">
        
        <!-- TEXTOS B√ÅSICOS -->
        <div class="section-header">1. Informa√ß√µes B√°sicas</div>
        <div class="control-group half-width">
            <label>T√≠tulo Principal</label>
            <input type="text" id="inputTitle" value="MOUSSE DE CHOCOLATE" oninput="updateLabels()">
        </div>
        <div class="control-group half-width">
            <label>Subt√≠tulo</label>
            <input type="text" id="inputSubtitle" value="ARTESANAL & CASEIRO" oninput="updateLabels()">
        </div>
        <div class="control-group full-width">
            <label>Ingredientes</label>
            <textarea id="inputIngred" rows="2" oninput="updateLabels()">Ingredientes: Leite Integral, Ovos, Chocolate, Mela√ßo.</textarea>
        </div>
        <div class="control-group">
            <label>Volume</label>
            <input type="text" id="inputVol" value="200ml" oninput="updateLabels()">
        </div>
        <div class="control-group">
            <label>Pre√ßo</label>
            <input type="text" id="inputPrice" value="R$ 8,00" oninput="updateLabels()">
        </div>
        <div class="control-group half-width"></div>

        <!-- FONTES E CORES -->
        <div class="section-header">2. Estilos, Fontes e Cores</div>
        
        <!-- T√≠tulo Config -->
        <div class="control-group half-width">
            <label>T√≠tulo</label>
            <div class="color-row">
                <input type="color" id="colorTitle" value="#3e2723" oninput="updateLabels()" title="Cor do T√≠tulo">
                <select id="fontTitle" onchange="updateLabels()" style="flex:1">
                    <option value="'Amatic SC', cursive">Amatic (R√∫stica)</option>
                    <option value="'Lato', sans-serif">Lato (Moderna)</option>
                    <option value="'Playfair Display', serif">Playfair (Elegante)</option>
                    <option value="'Oswald', sans-serif">Oswald (Forte)</option>
                    <option value="'Dancing Script', cursive">Dancing (Manuscrita)</option>
                </select>
            </div>
        </div>
        <div class="control-group half-width">
             <label>Tamanho T√≠tulo</label>
             <input type="number" id="sizeTitle" value="38" oninput="updateLabels()">
        </div>

        <!-- Subt√≠tulo Config -->
        <div class="control-group half-width">
            <label>Subt√≠tulo</label>
            <div class="color-row">
                <input type="color" id="colorSubtitle" value="#5d4037" oninput="updateLabels()" title="Cor do Subt√≠tulo">
                <select id="fontSubtitle" onchange="updateLabels()" style="flex:1">
                    <option value="'Lato', sans-serif">Lato (Moderna)</option>
                    <option value="'Amatic SC', cursive">Amatic (R√∫stica)</option>
                    <option value="'Roboto Mono', monospace">Mono (T√©cnica)</option>
                </select>
            </div>
        </div>
        <div class="control-group half-width">
            <label>Tamanho Sub.</label>
            <input type="number" id="sizeSubtitle" value="16" oninput="updateLabels()">
        </div>

        <!-- Ingredientes Config -->
        <div class="control-group half-width">
            <label>Ingredientes</label>
            <div class="color-row">
                <input type="color" id="colorIngred" value="#000000" oninput="updateLabels()" title="Cor dos Ingredientes">
                <select id="fontIngred" onchange="updateLabels()" style="flex:1">
                    <option value="'Lato', sans-serif">Lato (Leg√≠vel)</option>
                    <option value="'Roboto Mono', monospace">Mono (M√°quina)</option>
                    <option value="'Amatic SC', cursive">Amatic (R√∫stica)</option>
                </select>
            </div>
        </div>
        <div class="control-group half-width">
            <label>Tamanho Ingred.</label>
            <input type="number" id="sizeIngred" value="9" oninput="updateLabels()">
        </div>

        <!-- DIMENS√ïES E FUNDO -->
        <div class="section-header">3. Dimens√µes, Fundo e Margens</div>

        <div class="control-group">
            <label>L. R√≥tulo (mm)</label>
            <input type="number" id="dimW" value="190" oninput="updateLabels()">
        </div>
        <div class="control-group">
            <label>A. R√≥tulo (mm)</label>
            <input type="number" id="dimH" value="45" oninput="updateLabels()">
        </div>
        <div class="control-group">
            <label>Diam. Tampa</label>
            <input type="number" id="dimLid" value="65" oninput="updateLabels()">
        </div>
        <div class="control-group">
             <label>Qtd. Tampa</label>
            <input type="number" id="qtyLid" value="8" oninput="updateLabels()">
        </div>
        
        <div class="control-group half-width">
            <label>Cor de Fundo</label>
            <div class="color-row">
                <input type="color" id="bgColorPicker" value="#dcb694" oninput="syncColor('picker')">
                <input type="text" id="bgColorText" value="#dcb694" oninput="syncColor('text')" style="flex:1; text-transform:uppercase;">
            </div>
            <!-- NOVA FUNCIONALIDADE AQUI -->
            <label class="checkbox-wrapper">
                <input type="checkbox" id="transparentBg" onchange="updateLabels()">
                <span>Fundo Transparente (Sem Cor)</span>
            </label>
        </div>

        <div class="control-group half-width">
             <label>Cor Detalhes (Bordas)</label>
             <input type="color" id="colorDetails" value="#3e2723" oninput="updateLabels()" style="width:100%">
             <div style="margin-top:10px;">
                 <label>Qtd. Lateral</label>
                 <input type="number" id="qtySide" value="5" oninput="updateLabels()" style="width:100%">
             </div>
        </div>

        <div class="control-group full-width" style="margin-top: 5px; border-top: 1px dashed #eee; padding-top:10px;">
            <label>Margem Lateral da P√°gina (mm)</label>
            <div style="display:flex; align-items:center; gap:10px;">
                <input type="range" id="sheetMargin" min="0" max="50" value="10" oninput="updateLabels()">
                <span id="marginDisplay" style="font-size:12px; font-weight:bold;">10mm</span>
            </div>
        </div>

        <!-- A√á√ïES -->
        <div class="full-width" style="border-top: 2px solid #eee; padding-top: 20px; display:flex; gap:15px; margin-top:10px;">
            <div style="flex:1">
                <button class="btn-upload" onclick="document.getElementById('qrInput').click()">üìÅ Carregar QR Code</button>
                <input type="file" id="qrInput" accept="image/*" onchange="loadQR(event)" style="display:none">
            </div>
            <div style="flex:2">
                <button class="btn-action" onclick="window.print()">
                    <span>üñ®Ô∏è IMPRIMIR PROJETO</span>
                </button>
            </div>
        </div>
    </div>

    <!-- PREVIEW -->
    <div class="preview-container">
        
        <div class="sheet-wrapper">
            <div class="sheet-label">FOLHA 1: LATERAIS</div>
            <div id="sheet-kraft" class="sheet"></div>
        </div>

        <div class="sheet-wrapper">
            <div class="sheet-label">FOLHA 2: TAMPAS</div>
            <div id="sheet-white" class="sheet"></div>
        </div>

    </div>

    <script>
        let currentQR = null;

        function updateLabels() {
            // 1. Textos
            const title = document.getElementById('inputTitle').value;
            const subtitle = document.getElementById('inputSubtitle').value;
            const ingred = document.getElementById('inputIngred').value;
            const vol = document.getElementById('inputVol').value;
            const price = document.getElementById('inputPrice').value;

            // 2. Fontes & Tamanhos
            const fTitle = document.getElementById('fontTitle').value;
            const sTitle = document.getElementById('sizeTitle').value + 'px';
            const fSub = document.getElementById('fontSubtitle').value;
            const sSub = document.getElementById('sizeSubtitle').value + 'px';
            const fIng = document.getElementById('fontIngred').value;
            const sIng = document.getElementById('sizeIngred').value + 'px';

            // 3. Cores
            const cTitle = document.getElementById('colorTitle').value;
            const cSub = document.getElementById('colorSubtitle').value;
            const cIng = document.getElementById('colorIngred').value;
            const cDet = document.getElementById('colorDetails').value;
            
            // Fundo: Verifica se o Checkbox "Transparente" est√° marcado
            const isTransparent = document.getElementById('transparentBg').checked;
            const cBg = isTransparent ? 'transparent' : document.getElementById('bgColorText').value;

            // 4. Dimens√µes
            const dimW = document.getElementById('dimW').value + 'mm';
            const dimH = document.getElementById('dimH').value + 'mm';
            const dimLid = document.getElementById('dimLid').value + 'mm';
            const qtyS = document.getElementById('qtySide').value;
            const qtyL = document.getElementById('qtyLid').value;
            
            // Margens
            const marginVal = document.getElementById('sheetMargin').value;
            document.getElementById('marginDisplay').innerText = marginVal + 'mm';
            const sheets = document.querySelectorAll('.sheet');
            sheets.forEach(s => s.style.padding = `10mm ${marginVal}mm`);

            // --- RENDER SIDE ---
            const sheetKraft = document.getElementById('sheet-kraft');
            let htmlKraft = '';

            for(let i=0; i<qtyS; i++) {
                htmlKraft += `
                <div class="label-side" style="width:${dimW}; height:${dimH}; --label-bg: ${cBg}; --details-color: ${cDet};">
                    <div class="cut-guide"></div>
                    <div class="content">
                         <div class="text-area-left">
                            <h2 class="dynamic-title" style="font-family: ${fTitle}; font-size: ${sTitle}; color: ${cTitle};">${title}</h2>
                            <h3 class="dynamic-subtitle" style="font-family: ${fSub}; font-size: ${sSub}; color: ${cSub};">${subtitle}</h3>
                            <p class="dynamic-ingredients" style="font-family: ${fIng}; font-size: ${sIng}; color: ${cIng};">${ingred}</p>
                         </div>
                         <div class="info-box">
                            <span style="font-family:'Lato'; font-weight:bold; font-size:9px; text-transform:uppercase;">Peso Liq.</span>
                            <div style="font-size:18px; font-weight:bold; font-family:'Lato';">${vol}</div>
                         </div>
                    </div>
                </div>`;
            }
            sheetKraft.innerHTML = htmlKraft;

            // --- RENDER LID ---
            const sheetWhite = document.getElementById('sheet-white');
            let htmlWhite = '';
            
            // Cor do texto do QR deve contrastar
            const qrTextColor = isTransparent ? cDet : 'black';
            const qrBgColor = isTransparent ? cDet : 'black';
            const qrLabelColor = isTransparent ? (cBg === 'transparent' ? 'white' : 'white') : 'white'; 
            // Se transparente, o "box" do pre√ßo precisa ter fundo pra ler? Melhor manter o padr√£o preto/branco pra seguran√ßa.

            for(let i=0; i<qtyL; i++) {
                htmlWhite += `
                <div class="label-lid" style="width:${dimLid}; height:${dimLid};">
                    <div class="lid-cut-guide"></div>
                    <div class="inner-circle" style="background-color: ${cBg}; border-color:${cDet};">
                        <div style="font-family:'Lato'; font-size:8px; font-weight:bold; text-transform:uppercase; color:${cDet};">Escaneie</div>
                        <div class="qr-placeholder">
                            ${currentQR ? `<img src="${currentQR}">` : '<span style="font-size:9px; color:#ccc;">QR CODE</span>'}
                        </div>
                        <div style="font-family:'Lato'; font-size:12px; font-weight:bold; background:${cDet}; color:white; padding:2px 8px; border-radius:10px; margin-top:2px;">${price}</div>
                    </div>
                </div>`;
            }
            sheetWhite.innerHTML = htmlWhite;
        }

        function syncColor(source) {
            const picker = document.getElementById('bgColorPicker');
            const text = document.getElementById('bgColorText');
            if(source === 'picker') text.value = picker.value;
            else picker.value = text.value;
            updateLabels();
        }

        function loadQR(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentQR = e.target.result;
                    updateLabels();
                };
                reader.readAsDataURL(file);
            }
        }

        window.onload = updateLabels;
    </script>
</body>
</html>